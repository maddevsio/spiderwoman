
<html>
<head>
    <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/dataTables.bootstrap.min.css">
    <meta name="referrer" content="never">
    <script type="text/javascript" charset="utf8" src="//code.jquery.com/jquery-1.12.4.js"></script>
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.13/js/dataTables.bootstrap.min.js"></script>
    <script type="text/javascript" charset="utf8" src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/plug-ins/1.10.13/dataRender/datetime.js"></script>
    <script>
        var table;
        $(document).ready( function () {
            table = $('#table_id').DataTable({
                pageLength: 200,
                data: {{ .hosts }},
                columns: [
                    { data: "ID" },
                    { data: "HostName" },
                    { data: "HostType" }
                ],
                aoColumnDefs: [{
                  aTargets: [3],
                  data: {},
                  mRender: function(data, type, full) {
                    if(data['Action']=="add"){
                      return "<button onClick=addHost()>add</button>";
                    }
                    return "<button onClick=deleteHost("+data['ID']+")>delete</button>";
                  }
                }],
                order: [[ 0, "desc" ]],
            });

            $('#addNew').on('click', function(){
              table.row.add({
                "ID": "-",
                "HostName": "<input type='text' name='host_name' placeholder='Name'>",
                "HostType": "<input type='text' name='host_type' placeholder='Type'>",
                "Action": "add"
              }).draw(false);
            });
        } );
        function deleteHost(host){
          $.get( "/hosts/delete?host=" + host, function() {
            window.location.reload();
          });
        }
        function addHost(){
          var data = table.$('input').serialize();
          $.post( "/hosts/create", data, function() {
            window.location.reload();
          }).fail(function() {
            alert( "Such host already exists!" );
          });
        }
    </script>
</head>
<body style="padding: 15px 15px 15px 15px;">
<table id="table_id" class="table table-striped table-bordered" style="font-family:Arial; font-size:12px;">
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Type</th>
        <th>Action</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>ID</td>
        <td>HostName</td>
        <td>HostType</td>
        <td></td>
    </tr>
    </tbody>
</table>
<button id="addNew">Add New</button>
</body>
</html>
